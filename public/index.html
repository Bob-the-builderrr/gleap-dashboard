<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Team Performance Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <div class="wrap">
    <header class="head">
      <h1>Team Performance Dashboard</h1>
      <p>
        Live Gleap agent performance view: volumes, reply times, ratings, and active time in one place.
      </p>
    </header>

    <!-- Controls -->
    <section class="card controls">
      <div class="controls-row">
        <div class="field">
          <label for="startDate">Start</label>
          <input type="datetime-local" id="startDate" />
        </div>
        <div class="field">
          <label for="endDate">End</label>
          <input type="datetime-local" id="endDate" />
        </div>
        <div class="field">
          <label>Quick ranges</label>
          <div class="quick-buttons">
            <button type="button" class="chip" id="btn1h">Last 1 hour</button>
            <button type="button" class="chip" id="btn2h">Last 2 hours</button>
            <button type="button" class="chip" id="btn4h">Last 4 hours</button>
          </div>
        </div>
        <div class="field">
          <label>&nbsp;</label>
          <button type="button" class="primary" id="fetchBtn">
            <span id="fetchLabel">Fetch data</span>
            <span id="fetchSpinner" class="spinner" hidden></span>
          </button>
        </div>
      </div>

      <div class="controls-row meta-row">
        <div id="dateRangeLabel" class="muted"></div>
        <div id="lastUpdated" class="muted"></div>
      </div>
    </section>

    <!-- Summary cards -->
    <section class="stats-grid">
      <div class="stat-card">
        <div class="stat-label">Total tickets</div>
        <div class="stat-value" id="totalTickets">-</div>
        <div class="muted small">Across selected range</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Average rating</div>
        <div class="stat-value" id="avgRating">-</div>
        <div class="muted small">CSAT across active agents</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Active agents</div>
        <div class="stat-value" id="activeAgents">-</div>
        <div class="muted small">With at least one ticket</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Avg hours active</div>
        <div class="stat-value" id="avgHoursActive">-</div>
        <div class="muted small">Per active agent</div>
      </div>
    </section>

    <!-- Table -->
    <section class="card">
      <div class="section-head">
        <h2>Agent performance detail</h2>
        <div class="section-head-right">
          <span class="legend-dot legend-high"></span>
          <span class="legend-label">High volume</span>
          <span class="legend-dot legend-mid"></span>
          <span class="legend-label">Medium</span>
          <span class="legend-dot legend-low"></span>
          <span class="legend-label">Low</span>
        </div>
      </div>

      <div id="errorBox" class="alert" hidden></div>

      <div class="table-wrap">
        <table id="agentsTable">
          <thead>
            <tr>
              <th>Agent</th>
              <th>Email</th>
              <th class="sortable" data-sort-key="total_tickets">
                Total tickets <span class="sort-indicator"></span>
              </th>
              <th class="sortable" data-sort-key="closed_tickets">
                Closed <span class="sort-indicator"></span>
              </th>
              <th>Median reply</th>
              <th>First reply</th>
              <th>Assign reply</th>
              <th>Time to last close</th>
              <th class="sortable" data-sort-key="rating_score">
                Rating <span class="sort-indicator"></span>
              </th>
              <th class="sortable" data-sort-key="ticket_activity">
                Ticket activity <span class="sort-indicator"></span>
              </th>
              <th>Hours active</th>
            </tr>
          </thead>
          <tbody id="agentsTableBody">
            <tr id="noDataRow">
              <td colspan="11" class="empty">
                No data for this range
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </div>

  <script src="/dashboard.js"></script>
</body>
</html>
